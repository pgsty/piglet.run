---
title: 架构
linkTitle: 架构
weight: 20
icon: fa-solid fa-sitemap
---

## 系统架构

Piglet Run 基于 Pigsty 构建，提供精简的开发环境。

## 组件

| 组件 | 角色 | 端口 |
|------|------|------|
| **Nginx** | 反向代理，SSL 终止 | 80, 443 |
| **VS Code Server** | 网页版 IDE | /code |
| **JupyterLab** | 数据科学笔记本 | /jupyter |
| **PostgreSQL** | 主数据库 | 5432 |
| **JuiceFS** | 分布式文件系统 | - |
| **VictoriaMetrics** | 指标存储 | 8428 |
| **Grafana** | 监控仪表盘 | /ui |

## 网络架构

```
Internet
    │
    ▼
┌─────────┐
│  Nginx  │ :80, :443
└────┬────┘
     │
     ├──────────────┬──────────────┬──────────────┐
     │              │              │              │
     ▼              ▼              ▼              ▼
┌─────────┐   ┌─────────┐   ┌─────────┐   ┌─────────┐
│ VS Code │   │ Jupyter │   │ Grafana │   │   App   │
│ /code   │   │/jupyter │   │  /ui    │   │   /*    │
└─────────┘   └─────────┘   └─────────┘   └─────────┘
```

## 存储架构

所有开发工作通过 JuiceFS 存储在 PostgreSQL 中：

```
┌─────────────────────────────────────┐
│          工作目录                    │
│         ~/workspace                 │
└──────────────┬──────────────────────┘
               │
               ▼
┌─────────────────────────────────────┐
│            JuiceFS                  │
│     (POSIX 兼容文件系统)             │
└──────────────┬──────────────────────┘
               │
               ▼
┌─────────────────────────────────────┐
│          PostgreSQL                 │
│     (元数据 + 数据块)                │
└─────────────────────────────────────┘
```

## 下一步

- 了解 [存储](/docs/concept/storage/)
- 理解 [快照](/docs/concept/snapshot/)
